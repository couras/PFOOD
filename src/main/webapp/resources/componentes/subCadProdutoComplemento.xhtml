<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ps="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:co="http://xmlns.jcp.org/jsf/composite/component">

    <!-- INTERFACE -->
    <cc:interface>
    </cc:interface>

    <!-- IMPLEMENTATION -->
    <cc:implementation>


        <h:panelGroup layout="block"  id="panelGroupSubcadProd" >
            <h:panelGroup layout="block"  id="panelGroupSubcadProdRendered"  rendered="#{produtoMB.obj.idProduto > 0}" >   
                <!-- Nav tabs -->           
                <h:form prependId="false">
                    <ul class="nav nav-tabs" role="tablist">

                        <li role="presentation" class="active">
                            <h:commandLink ps:href="#complementosPadrao" ps:aria-controls="complementosPadrao" role="tab" ps:data-toggle="tab" value="Complementos Padrao">

                            </h:commandLink>
                        </li>
                        <li role="presentation">
                            <h:commandLink ps:href="#complementosAdicionais" ps:aria-controls="complementosAdicionais" role="tab" ps:data-toggle="tab" value="Complementos Adicionais">

                            </h:commandLink>
                        </li>
                        <li role="presentation"><a href="#complementosOpcionais" aria-controls="complementosOpcionais" role="tab" data-toggle="tab">Complementos Opcionais</a></li>
                        <li role="presentation"><a href="#imagens" aria-controls="imagens" role="tab" data-toggle="tab">Imagens</a></li>

                    </ul>
                </h:form>
                <!-- Tab panes -->
                <div class="tab-content">

                    <div role="tabpanel" class="tab-pane active" id="complementosPadrao">

                        <h:form prependId="false">

                            <h:panelGroup id="panelGroupCPPEditor" layout="block" >
                                <p:dataTable id="dataTableGrupoProd" widgetVar="dataTableGrupoProd"  var="grupoProd" style="font-size: 12px;" value="#{produtoComplementoMB.lista}"
                                             paginator="true"
                                             paginatorTemplate="{PageLinks}"
                                             rows="10">


                                    <p:column headerText="Descrição" >
                                        <h:outputText value="#{cpp.descricaoAgrupamento}" />
                                    </p:column>

                                    <p:column>
                                        <h:commandButton value="edit" > 
                                            <f:ajax onevent="prodcompevt"   listener="#{produtoComplementoMB.setObj(grupoProd)}" execute="@this" render=":cadGrupoProd:subCadProdComp:panelGridDadosPadrao"/>    
                                        </h:commandButton>
                                    </p:column>
                                    <p:column>
                                        <h:commandButton value="remove"  > 
                                            <f:ajax   listener="#{produtoComplementoMB.remove(grupoProd)}"  execute="@this" render="cadGrupoProd:subCadProdComppanelGroupCPPEditor :cadGrupoProd:subCadProdComp:panelGridDadosPadrao :cadProd:panelGridDadosPadrao"/>                  
                                        </h:commandButton>
                                    </p:column>

                                    <f:facet name="footer">
                                        <h:commandLink class="btn btn-default"  actionListener="#{produtoComplementoMB.novo()}" title="Novo Registro" value="Novo">
                                            <i class="fa fa-star fa-fw"></i>
                                            <f:ajax  onevent="prodcompevt"  execute="@this" render=":cadGrupoProd:subCadProdComp:panelGridDadosPadrao"/>

                                            <script>
                                                function prodcompevt(e) {
                                                    if (e.status == "success")
                                                        $('#subCadCompProdPToggle').collapse('show')
                                                }
                                            </script>
                                        </h:commandLink>
                                    </f:facet>

                                </p:dataTable>

                            </h:panelGroup>
                        </h:form>

                        <hr/>
                        <!--modal-->
                        <div   id="subCadCompProdPToggle" class="collapse">
                            <h:form prependId="false">
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <button type="button" class="close" onclick="$('#subCadCompProdPToggle').collapse('hide')" aria-hidden="true">×</button>
                                        <h4 class="panel-title">Dados do Grupo</h4>
                                    </div>
                                    <h:panelGroup id="panelGridDadosPadrao" layout="block"  class="panel-body">

                                        <h:panelGroup layout="block"  class="form-group">
                                            <div class="input-group number-spinner col-sm-12 col-lg-12">
                                                <h:outputLabel class="control-label" for="inputTextDescricaoAgrupamento" value="Descricao"/>
                                                <h:inputText class="form-control" id="inputTextDescricaoAgrupamento" value="#{produtoComplementoMB.obj.descricaoAgrupamento}" >
                                                </h:inputText>
                                            </div>    
                                        </h:panelGroup>
                                        <h:panelGroup layout="block"  class="form-group">
                                            <h:outputLabel class="control-label" for="autoCompleteCPP" value="Complemento"/>
                                            <div class="input-group number-spinner col-sm-3 col-lg-5">
                                                <p:autoComplete id="autoCompleteCPP" value="#{produtoComplementoMB.obj.complemento}" completeMethod="#{produtoComplementoMB.autoCompleteComplemento}"
                                                                var="c" itemLabel="#{c.descricao}" itemValue="#{c}" converter="complementoConverter" forceSelection="true" />                                              
                                            </div>
                                        </h:panelGroup>
                                        <h:panelGroup layout="block"  class="form-group">
                                            <co:spinner ids="spinQtde" label="Quantidade padrao" min="1" max="1000" value="#{produtoComplementoMB.obj.quantidade}"  />
                                        </h:panelGroup>
                                        <h:panelGroup layout="block"  class="form-group">
                                            <co:spinner ids="inputTextQtdelim" label="Quantidade maxima" min="0" max="1000" value="#{produtoComplementoMB.obj.quantidadeLimite}" />
                                        </h:panelGroup>


                                    </h:panelGroup>

                                    <h:panelGroup layout="block"  class="panel-footer">

                                        <h:commandButton class="btn btn-primary" value="Salvar" id="btnSubmitGrupoProd"   >
                                            <f:ajax execute="panelGridDadosPadrao"  listener="#{produtoComplementoMB.save()}"  render="panelGridDadosPadrao :cadGrupoProd:subCadProdComp:panelGroupCPPEditor :cadProd:panelGridDadosPadrao" />

                                        </h:commandButton>
                                    </h:panelGroup>


                                </div>

                            </h:form>
                        </div>
                    </div>

                    <div role="tabpanel" class="tab-pane" id="complementosAdicionais">



                    </div>


                    <div role="tabpanel" class="tab-pane" id="complementosOpcionais">...</div>
                    <div role="tabpanel" class="tab-pane" id="imagens">...</div>
                </div>
            </h:panelGroup>
        </h:panelGroup>

    </cc:implementation>
</html>